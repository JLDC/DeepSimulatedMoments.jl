<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · DeepSimulatedMoments</title><meta name="title" content="API · DeepSimulatedMoments"/><meta property="og:title" content="API · DeepSimulatedMoments"/><meta property="twitter:title" content="API · DeepSimulatedMoments"/><meta name="description" content="Documentation for DeepSimulatedMoments."/><meta property="og:description" content="Documentation for DeepSimulatedMoments."/><meta property="twitter:description" content="Documentation for DeepSimulatedMoments."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DeepSimulatedMoments</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../DGPs/">Data generating processes</a></li><li><a class="tocitem" href="../MGNs/">Moment Generating Networks</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Data-Generating-Processes"><span>Data Generating Processes</span></a></li><li><a class="tocitem" href="#Moment-Networks"><span>Moment Networks</span></a></li><li><a class="tocitem" href="#Neural-Networks"><span>Neural Networks</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JLDC/DeepSimulatedMoments.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/master/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Data-Generating-Processes"><a class="docs-heading-anchor" href="#Data-Generating-Processes">Data Generating Processes</a><a id="Data-Generating-Processes-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Generating-Processes" title="Permalink"></a></h2><h3 id="AbstractDGP"><a class="docs-heading-anchor" href="#AbstractDGP">AbstractDGP</a><a id="AbstractDGP-1"></a><a class="docs-heading-anchor-permalink" href="#AbstractDGP" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.AbstractDGP" href="#DeepSimulatedMoments.AbstractDGP"><code>DeepSimulatedMoments.AbstractDGP</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractDGP{T&lt;:AbstractFloat}</code></pre><p>Abstract type for a DGP.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/AbstractDGP.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.nfeatures" href="#DeepSimulatedMoments.nfeatures"><code>DeepSimulatedMoments.nfeatures</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nfeatures(d::AbstractDGP)</code></pre><p>Number of features in the data.</p><p><strong>Arguments</strong></p><ul><li><code>d::AbstractDGP</code>: DGP to get the number of features from.</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: Number of features.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/AbstractDGP.jl#L15-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.nparams" href="#DeepSimulatedMoments.nparams"><code>DeepSimulatedMoments.nparams</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nparams(d::AbstractDGP)</code></pre><p>Number of parameters in the DGP.</p><p><strong>Arguments</strong></p><ul><li><code>d::AbstractDGP</code>: DGP to get the number of parameters from.</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: Number of parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/AbstractDGP.jl#L28-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.priordraw" href="#DeepSimulatedMoments.priordraw"><code>DeepSimulatedMoments.priordraw</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">priordraw(d::AbstractDGP, S::Int)</code></pre><p>Draw <code>S</code> parameter samples from the prior.</p><p><strong>Arguments</strong></p><ul><li><code>d::AbstractDGP{T}</code>: DGP to draw the parameters from.</li><li><code>S::Int</code>: Number of samples to draw.</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{T}</code>: <code>S</code> samples of the parameters (dimension: <code>S × nparams(d)</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/AbstractDGP.jl#L46-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.generate" href="#DeepSimulatedMoments.generate"><code>DeepSimulatedMoments.generate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate(θ::AbstractVector{T}, d::AbstractDGP{T}, S::Int)</code></pre><p>Generate <code>S</code> data samples from the DGP at parameters <code>θ</code>.</p><p><strong>Arguments</strong></p><ul><li><code>θ::AbstractVector{T}</code>: Parameters of DGP used to generate the data.</li><li><code>d::AbstractDGP{T}</code>: DGP to generate the data from.</li><li><code>S::Int</code>: Number of samples to generate.</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{T}</code>: <code>S</code> samples of the data (dimension: <code>nfeatures(d) × S × N</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/AbstractDGP.jl#L97-L109">source</a></section><section><div><pre><code class="language-julia hljs">generate(dgp::AbstractDGP, net::MomentNetwork, nsamples::Int)</code></pre><p>Generate data from a DGP and apply the data and parameter transforms from the moment network.</p><p><strong>Arguments</strong></p><ul><li><code>dgp::AbstractDGP</code>: The DGP to generate data from.</li><li><code>net::MomentNetwork</code>: The moment network.</li><li><code>nsamples::Int</code>: The number of samples to generate.</li></ul><p><strong>Returns</strong></p><ul><li><code>X</code>: The transformed data.</li><li><code>Y</code>: The transformed parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/MomentNetwork.jl#L82-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.datatransform" href="#DeepSimulatedMoments.datatransform"><code>DeepSimulatedMoments.datatransform</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">datatransform(d::AbstractDGP, S::Int; dev=cpu)</code></pre><p>Fit a <code>ZScoreTransform</code> data transform to the data generated from the DGP.</p><p><strong>Arguments</strong></p><ul><li><code>d::AbstractDGP{T}</code>: DGP to generate the data from.</li><li><code>S::Int</code>: Number of samples to generate.</li><li><code>dev</code>: Device to fit the transform on (default: <code>cpu</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>ZScoreTransform</code>: Data transform.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/AbstractDGP.jl#L65-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.likelihood" href="#DeepSimulatedMoments.likelihood"><code>DeepSimulatedMoments.likelihood</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">likelihood(d::AbstractDGP, X::AbstractArray, θ::AbstractVector)</code></pre><p>Compute the log-likelihood of the data <code>X</code> given the parameters <code>θ</code>. This  function is irrelevant for DGPs with an intractable likelihood.</p><p><strong>Arguments</strong></p><ul><li><code>d::AbstractDGP{T}</code>: DGP to compute the log-likelihood for.</li><li><code>X::AbstractArray{T}</code>: Data to compute the log-likelihood for.</li><li><code>θ::AbstractVector{T}</code>: Parameters to compute the log-likelihood for.</li></ul><p><strong>Returns</strong></p><ul><li><code>T</code>: Log-likelihood of the data given the parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/AbstractDGP.jl#L113-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.ErrorDistribution" href="#DeepSimulatedMoments.ErrorDistribution"><code>DeepSimulatedMoments.ErrorDistribution</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ErrorDistribution</code></pre><p>A distribution for the error term in a <a href="#AbstractDGP"><code>AbstractDGP</code>`</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/ErrorDistribution.jl#L2-L6">source</a></section></article><h3 id="Predefined-DGPs"><a class="docs-heading-anchor" href="#Predefined-DGPs">Predefined DGPs</a><a id="Predefined-DGPs-1"></a><a class="docs-heading-anchor-permalink" href="#Predefined-DGPs" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.MA2" href="#DeepSimulatedMoments.MA2"><code>DeepSimulatedMoments.MA2</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MA2{T} &lt;: AbstractDGP{T}</code></pre><p>A simple MA(2) process. (<code>T</code> defaults to <code>Float32</code>)</p><p><strong>Fields</strong></p><ul><li><code>N::Int</code>: Number of observations in each sample.</li><li><code>dist::ErrorDistribution</code>: Distribution of the error term.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/MA2.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.Logit" href="#DeepSimulatedMoments.Logit"><code>DeepSimulatedMoments.Logit</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Logit{T} &lt;: AbstractDGP{T}</code></pre><p>A simple logistic regression model. (<code>T</code> defaults to <code>Float32</code>)</p><p><strong>Fields</strong></p><ul><li><code>N::Int</code>: Number of observations in each sample.</li><li><code>K::Int</code>: Number of features in each sample.</li><li><code>dist::ErrorDistribution</code>: Distribution of the error term.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/Logit.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.GARCH" href="#DeepSimulatedMoments.GARCH"><code>DeepSimulatedMoments.GARCH</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GARCH{T} &lt;: AbstractDGP{T}</code></pre><p>A simple GARCH(1,1) process. (<code>T</code> defaults to <code>Float32</code>)</p><p><strong>Fields</strong></p><ul><li><code>N::Int</code>: Number of observations in each sample.</li><li><code>dist::ErrorDistribution</code>: Distribution of the error term.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/GARCH.jl#L3-L11">source</a></section></article><h4 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.generate_files" href="#DeepSimulatedMoments.generate_files"><code>DeepSimulatedMoments.generate_files</code></a> — <span class="docstring-category">Function</span></header><section><div><p>generate<em>files(dgp::AbstractDGP, dir::String, nfiles::Int;          batchsize::Int=1</em>024, verbosity::Int=(nfiles ÷ 10),          preprocessX::Function=identity, preprocessY::Function=identity     )</p><p>Generate data files from a <a href="#DeepSimulatedMoments.AbstractDGP"><code>AbstractDGP</code></a> and save it to a directory. Note that if  the directory already contains files, the function will continue from the last  file until the directory contains <code>nfiles</code>.</p><p><strong>Arguments</strong></p><ul><li><code>dgp::AbstractDGP</code>: The <a href="#DeepSimulatedMoments.AbstractDGP"><code>AbstractDGP</code></a> to generate data from.</li><li><code>dir::String</code>: The directory to save the data to.</li><li><code>nfiles::Int</code>: The number of files to generate.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>batchsize::Int</code>: The batch size (default: <code>1024</code>).</li><li><code>verbosity::Int</code>: The verbosity (default: <code>nfiles ÷ 10</code>).</li><li><code>preprocessX::Function</code>: The preprocessing function for the data (default: <code>identity</code>).</li><li><code>preprocessY::Function</code>: The preprocessing function for the parameters (default: <code>identity</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/utils.jl#L2-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.load_from_file" href="#DeepSimulatedMoments.load_from_file"><code>DeepSimulatedMoments.load_from_file</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_from_file(file::String)</code></pre><p>Load pre-generated data from a file.</p><p><strong>Arguments</strong></p><ul><li><code>file::String</code>: The file to load the data from.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/DGPs/utils.jl#L53-L60">source</a></section></article><h2 id="Moment-Networks"><a class="docs-heading-anchor" href="#Moment-Networks">Moment Networks</a><a id="Moment-Networks-1"></a><a class="docs-heading-anchor-permalink" href="#Moment-Networks" title="Permalink"></a></h2><h3 id="HyperParameters"><a class="docs-heading-anchor" href="#HyperParameters">HyperParameters</a><a id="HyperParameters-1"></a><a class="docs-heading-anchor-permalink" href="#HyperParameters" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.HyperParameters" href="#DeepSimulatedMoments.HyperParameters"><code>DeepSimulatedMoments.HyperParameters</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HyperParameters</code></pre><p>Hyperparameters for training a <a href="#DeepSimulatedMoments.MomentNetwork"><code>MomentNetwork</code></a>.</p><p><strong>Fields</strong></p><ul><li><code>dev</code>: The device to train on.</li><li><code>loss</code>: The loss function.</li><li><code>batchsize</code>: The batch size.</li><li><code>nsamples</code>: The number of samples to generate.</li><li><code>epochs</code>: The number of epochs to train for.</li><li><code>validation_size</code>: The number of samples to use for validation.</li><li><code>validation_freq</code>: The frequency with which to validate.</li><li><code>print_every</code>: The frequency with which to print information about the training process.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/HyperParameters.jl#L3-L18">source</a></section></article><h3 id="MomentNetwork"><a class="docs-heading-anchor" href="#MomentNetwork">MomentNetwork</a><a id="MomentNetwork-1"></a><a class="docs-heading-anchor-permalink" href="#MomentNetwork" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.MomentNetwork" href="#DeepSimulatedMoments.MomentNetwork"><code>DeepSimulatedMoments.MomentNetwork</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MomentNetwork</code></pre><p>A neural network that estimates the parameters of a DGP.</p><p><strong>Fields</strong></p><ul><li><code>model</code>: The neural network.</li><li><code>optimizer</code>: The optimizer.</li><li><code>best_model</code>: The best model found during training.</li><li><code>hyperparameters</code>: The hyperparameters.</li><li><code>preprocess</code>: The preprocessing function.</li><li><code>parameter_transform</code>: The parameter transform.</li><li><code>data_transform</code>: The data transform.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/MomentNetwork.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.train_network!" href="#DeepSimulatedMoments.train_network!"><code>DeepSimulatedMoments.train_network!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">train_network!(net::MomentNetwork, dgp::AbstractDGP; verbose::Bool=true)</code></pre><p>Train a moment network on a DGP.</p><p><strong>Arguments</strong></p><ul><li><code>net::MomentNetwork</code>: The moment network.</li><li><code>dgp::AbstractDGP</code>: The DGP to train on.</li><li><code>verbose::Bool</code>: Whether to print information about the training process.</li></ul><p><strong>Returns</strong></p><ul><li><code>iterations</code>: The iterations at which the losses were computed.</li><li><code>losses</code>: The losses at each iteration.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/MomentNetwork.jl#L115-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.apply_transforms" href="#DeepSimulatedMoments.apply_transforms"><code>DeepSimulatedMoments.apply_transforms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">apply_transforms(net::MomentNetwork, X, Y)</code></pre><p>Apply the data and parameter transforms to the data and parameters, respectively.</p><p><strong>Arguments</strong></p><ul><li><code>net::MomentNetwork</code>: The moment network.</li><li><code>X</code>: The data to apply the data transform to.</li><li><code>Y</code>: The parameters to apply the parameter transform to.</li></ul><p><strong>Returns</strong></p><ul><li><code>X</code>: The transformed data.</li><li><code>Y</code>: The transformed parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/MomentNetwork.jl#L61-L74">source</a></section></article><h2 id="Neural-Networks"><a class="docs-heading-anchor" href="#Neural-Networks">Neural Networks</a><a id="Neural-Networks-1"></a><a class="docs-heading-anchor-permalink" href="#Neural-Networks" title="Permalink"></a></h2><h3 id="Temporal-Convolutional-Networks"><a class="docs-heading-anchor" href="#Temporal-Convolutional-Networks">Temporal Convolutional Networks</a><a id="Temporal-Convolutional-Networks-1"></a><a class="docs-heading-anchor-permalink" href="#Temporal-Convolutional-Networks" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.TemporalBlock" href="#DeepSimulatedMoments.TemporalBlock"><code>DeepSimulatedMoments.TemporalBlock</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">TemporalBlock(chan_in, chan_out; dilation, kernel_size, residual, pad)</code></pre><p>Temporal block with <code>chan_in</code> input channels and <code>chan_out</code> output channels. Each block consists of two causal convolutional layers with <code>kernel_size</code> and <code>dilation</code> followed by batch normalization. If <code>residual</code> is <code>true</code>, a skip connection is added.</p><p><strong>Arguments</strong></p><ul><li><code>chan_in::Int</code>: Number of input channels.</li><li><code>chan_out::Int</code>: Number of output channels.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>dilation::Int</code>: Kernel dilation.</li><li><code>kernel_size::Int</code>: Size of the convolutional kernel.</li><li><code>residual::Bool</code>: Whether to use residual connections.</li><li><code>pad</code>: Padding to use for the convolutional layers.</li></ul><p><strong>Returns</strong></p><ul><li><code>Chain</code>: Temporal block</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/TCN.jl#L3-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.TCN" href="#DeepSimulatedMoments.TCN"><code>DeepSimulatedMoments.TCN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">TCN(channels; kernel_size, dilation_factor, residual, pad)</code></pre><p>Temporal convolutional network (TCN) with <code>length(channels) - 1</code> layers. Each layer is a <code>TemporalBlock</code> with <code>channels[i]</code> input channels and <code>channels[i+1]</code></p><p><strong>Arguments</strong></p><ul><li><code>channels::AbstractVector{Int}</code>: Number of input and output channels for each layer.</li><li><code>kernel_size::Int</code>: Size of the convolutional kernel.</li><li><code>dilation_factor::Int</code>: Factor by which the dilation is increased for each layer. (default: <code>2</code>)</li><li><code>residual::Bool</code>: Whether to use residual connections. (default: <code>true</code>)</li><li><code>pad</code>: Padding to use for the convolutional layers. (default: <code>SamePad()</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>Chain</code>: TCN</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/TCN.jl#L48-L63">source</a></section></article><h4 id="Utilities-2"><a class="docs-heading-anchor" href="#Utilities-2">Utilities</a><a class="docs-heading-anchor-permalink" href="#Utilities-2" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.build_tcn" href="#DeepSimulatedMoments.build_tcn"><code>DeepSimulatedMoments.build_tcn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">build_tcn(d::AbstractDGP; dilation_factor, kernel_size, channels, 
    summary_size, residual, pad)</code></pre><p>Builds a TCN for a specified DGP.</p><p><strong>Arguments</strong></p><ul><li><code>d::AbstractDGP</code>: DGP to build the TCN for.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>nlayers::Int</code>: Number of layers. (default: <code>0</code>, computes the necessary    layers using <a href="#DeepSimulatedMoments.receptive_field_size"><code>receptive_field_size</code></a>)</li><li><code>dilation_factor::Int</code>: Dilation factor. (default: <code>2</code>)</li><li><code>kernel_size::Int</code>: Size of the convolutional kernel. (default: <code>8</code>)</li><li><code>channels::Int</code>: Number of channels. (default: <code>32</code>)</li><li><code>receptive_field_size::Int</code>: Receptive field size. (default: <code>0</code>, uses the    length of the <a href="#DeepSimulatedMoments.AbstractDGP"><code>AbstractDGP</code></a> instead)</li><li><code>summary_size::Int</code>: Size of the summary convolution. (default: <code>10</code>)</li><li><code>residual::Bool</code>: Whether to use residual connections. (default: <code>true</code>)</li><li><code>pad</code>: Padding function. (default: <code>SamePad()</code>)</li><li><code>dev::Function</code>: Device to use. (default: <code>cpu</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>Chain</code>: TCN for the specified DGP.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/tcn_utils.jl#L49-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.receptive_field_size" href="#DeepSimulatedMoments.receptive_field_size"><code>DeepSimulatedMoments.receptive_field_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">receptive_field_size(dilation, kernel_size, layers)</code></pre><p>Computes the receptive field size for a specified dilation, kernel size, and  number of layers.</p><p><strong>Arguments</strong></p><ul><li><code>dilation::Int</code>: Dilation factor.</li><li><code>kernel_size::Int</code>: Size of the convolutional kernel.</li><li><code>layers::Int</code>: Number of layers.</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: Receptive field size.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/tcn_utils.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.necessary_layers" href="#DeepSimulatedMoments.necessary_layers"><code>DeepSimulatedMoments.necessary_layers</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">necessary_layers(dilation, kernel_size, receptive_field)</code></pre><p>Computes the minimum number of layers necessary to achieve a specified receptive field size.</p><p><strong>Arguments</strong></p><ul><li><code>dilation::Int</code>: Dilation factor.</li><li><code>kernel_size::Int</code>: Size of the convolutional kernel.</li><li><code>receptive_field::Int</code>: Desired receptive field size.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>use_ceil::Bool</code>: Whether to use <code>ceil(Int, x)</code> for the output. (default: <code>false</code>)</li><li><code>use_floor::Bool</code>: Whether to use <code>floor(Int, x)</code> for the output. (default: <code>false</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Minimum number of layers (without <code>use_ceil</code> or <code>use_floor</code>, this is a <code>Float64</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/tcn_utils.jl#L20-L37">source</a></section></article><h3 id="Recurrent-Neural-Networks"><a class="docs-heading-anchor" href="#Recurrent-Neural-Networks">Recurrent Neural Networks</a><a id="Recurrent-Neural-Networks-1"></a><a class="docs-heading-anchor-permalink" href="#Recurrent-Neural-Networks" title="Permalink"></a></h3><h4 id="Utilities-3"><a class="docs-heading-anchor" href="#Utilities-3">Utilities</a><a class="docs-heading-anchor-permalink" href="#Utilities-3" title="Permalink"></a></h4><h3 id="General-Neural-Network-Utilities"><a class="docs-heading-anchor" href="#General-Neural-Network-Utilities">General Neural Network Utilities</a><a id="General-Neural-Network-Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#General-Neural-Network-Utilities" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.tabular2conv" href="#DeepSimulatedMoments.tabular2conv"><code>DeepSimulatedMoments.tabular2conv</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tabular2conv(X::AbstractArray{T, 3}) where T</code></pre><p>Transform a (<code>K × S × T</code>) array to a CNN format (<code>1 × T × K × S</code> array). <code>K</code> is the number of features, <code>S</code> is the number of samples, and <code>T</code> is the number of time steps / observations in each sample.</p><p><strong>Arguments</strong></p><ul><li><code>X::AbstractArray{T, 3}</code>: Array to transform.</li></ul><p><strong>Returns</strong></p><ul><li><code>Array{T, 4}</code>: CNN format of <code>X</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/utils.jl#L19-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DeepSimulatedMoments.tabular2rnn" href="#DeepSimulatedMoments.tabular2rnn"><code>DeepSimulatedMoments.tabular2rnn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tabular2rnn(X::AbstractArray{T, 3}) where T</code></pre><p>Transform a (<code>K × S × T</code>) array to an RNN format (<code>T</code>-array of <code>K × S</code> matrices). <code>K</code> is the number of features, <code>S</code> is the number of samples, and <code>T</code> is the number  of time steps / observations in each sample.</p><p><strong>Arguments</strong></p><ul><li><code>X::AbstractArray{T, 3}</code>: Array to transform.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Matrix{T}}</code>: RNN format of <code>X</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JLDC/DeepSimulatedMoments.jl/blob/e2a62a0069ccc3449cac1bd929bbef554b1dc66b/src/NeuralNets/utils.jl#L4-L16">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../MGNs/">« Moment Generating Networks</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Wednesday 21 February 2024 08:45">Wednesday 21 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
